<%= simple_nested_form_for(doctor, :html => { :class => 'form-horizontal' }) do |f| %>
  <fieldset>
  <!-- INFOS DO MÉDICO -->
    <%= f.input :name %>
    <%= f.input :email %>
    <% if doctor.new_record? %>
      <%= f.input :username %>
    <% else %>
      <%= f.input :username, :disabled => true %>
    <% end %>
    <%= f.input :cpf %>
    <%= f.input :rg %>
    <%= f.input :birthdate, as: :string, :input_html => {:class => 'datepicker'} %>
    <%= f.input :crm %>
    <%= f.input :gradyear, as: :string, :input_html => {:class => 'datepicker'}  %>
    <%= f.association :occupations, :as => :check_boxes  %>
    <%= f.input :appointmentprice, :as => :currency, :input_html => {:class => 'input-small'} %>
    <%= f.association :health_insurances, :as => :check_boxes %>
    <%= f.simple_fields_for :contact_infos do |cinfos_form| %>
      <%= cinfos_form.input :type, :collection => ContactInfo.contact_types , :label => false, :default => false %>
      <%= cinfos_form.input :value, :label => false %>
      <%= cinfos_form.link_to_remove "Remover contato" %>
    <% end %>
    <%= f.link_to_add "Adicionar contato", :contact_infos %>

    <!-- INFOS DA AGENDA -->
    <% if doctor.new_record? %>
      <br />
      <%= f.simple_fields_for :agenda do |ag_form| %>
        <fieldset>
          <legend>
            Criar agenda do médico
          </legend>
          <%= ag_form.input :default_meeting_length, :as => :minutes, :input_html => {:class => 'input-small'} %>
          <%= ag_form.simple_fields_for :available_days do |avd_form| %>
            <%= avd_form.input :day, :collection => AvailableDay.days, :include_blank=>'Selecione um dia' %>
            <%= avd_form.input :work_start_time, :as => :time, :input_html => {:class => 'input-small'} %>
            <%= avd_form.input :work_end_time, :as => :time, :input_html => {:class => 'input-small'} %>
            <%= avd_form.input :interval_start_time, :as => :time, :input_html => {:class => 'input-small'} %>
            <%= avd_form.input :interval_end_time, :as => :time, :input_html => {:class => 'input-small'} %>
            <%= avd_form.link_to_remove "Remover dia" %>
          <% end %>
          <%= ag_form.link_to_add "Adicionar dia de trabalho", :available_days %>
        </fieldset>
      <% end %>
    <% end %>

    <div class="form-actions">
      <%= f.button :submit, "Salvar" %>
      <%= link_to "Cancelar", doctors_path, :class => :btn %>
    </div>

  </fieldset>
<% end %>
      

